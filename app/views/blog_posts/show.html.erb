<% content_for :title, @blog_post.title %>

<div class="max-w-3xl mx-auto mt-8">

  <!-- Blog Banner -->
  <% if @blog_post.banner_image.attached? %>
    <div class="mb-6 rounded-xl overflow-hidden shadow-sm">
      <% if defined?(ImageProcessing) %>
        <%= image_tag @blog_post.banner_image.variant(resize_to_limit: [1200, 600]),
            alt: @blog_post.title, class: "w-full object-cover" %>
      <% else %>
        <%= image_tag @blog_post.banner_image,
            alt: @blog_post.title, class: "w-full object-cover" %>
      <% end %>
    </div>
  <% end %>

  <!-- Title & Date -->
  <h1 class="text-4xl font-bold mb-2"><%= @blog_post.title %></h1>
  <p class="text-gray-500 text-sm mb-8">
    <%= @blog_post.created_at.strftime("%B %d, %Y") %>
  </p>

  <!-- Blog Body -->
  <div class="prose prose-lg max-w-none mb-12">
    <%= @blog_post.body %>
  </div>

  <!-- Actions -->
  <div class="flex flex-wrap gap-3 mb-12">
    <%= link_to "Edit", edit_blog_post_path(@blog_post),
        class: "px-4 py-2 rounded-lg bg-gray-100 hover:bg-gray-200 text-sm font-medium" %>

    <%= link_to "Back", blog_posts_path,
        class: "px-4 py-2 rounded-lg bg-gray-100 hover:bg-gray-200 text-sm font-medium" %>

    <%= button_to "Delete",
        @blog_post,
        method: :delete,
        data: { turbo_confirm: "Are you sure?" },
        class: "px-4 py-2 rounded-lg bg-red-600 text-white hover:bg-red-500 text-sm font-medium" %>
  </div>

  <!-- Comments Section -->
  <div class="mt-10">
    <h2 class="text-2xl font-semibold mb-4">Comments (<%= @blog_post.comments.count %>)</h2>

    <!-- List of Comments -->
    <div class="space-y-5 mb-6">
      <% @blog_post.comments.each do |comment| %>
        <div class="border border-gray-200 p-4 rounded-lg bg-white">
          <p class="font-medium text-gray-900"><%= comment.name %></p>
          <p class="text-sm text-gray-500 mb-2"><%= comment.created_at.strftime("%B %d, %Y") %></p>
          <p class="text-gray-700"><%= comment.body %></p>
        </div>
      <% end %>
    </div>

    <!-- New Comment Form -->
    <h3 class="text-xl font-semibold mb-3">Add a Comment</h3>

    <%= form_with(model: [@blog_post, Comment.new], class: "space-y-4") do |f| %>
      <div>
        <%= f.label :name, class: "block font-medium mb-1" %>
        <%= f.text_field :name, class: "w-full border-gray-300 rounded-md" %>
      </div>

      <div>
        <%= f.label :body, "Comment", class: "block font-medium mb-1" %>
        <%= f.text_area :body, rows: 4, class: "w-full border-gray-300 rounded-md" %>
      </div>

      <%= f.submit "Post Comment", class: "px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-500 font-medium" %>
    <% end %>
  </div>

</div>
